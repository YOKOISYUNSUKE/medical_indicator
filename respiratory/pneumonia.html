<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>肺炎重症度 | 医療電算機</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- 共通CSS（分割後） -->
  <link rel="stylesheet" href="../css/base.css" />
  <link rel="stylesheet" href="../css/layout.css" />
  <link rel="stylesheet" href="../css/components.css" />
  <link rel="stylesheet" href="../css/responsive.css" />

  <!-- 共通ヘッダー/フッター読込 -->
  <script src="../js/include.js" defer></script>
  <!-- 共通スコアユーティリティ -->
  <script src="../js/score-utils.js" defer></script>

  <!-- このスコア専用の計算JSがあればここに -->
  <script src="pneumonia.js" defer></script>
</head>

<!-- data-subtitle に、このページ固有のサブタイトルを書く -->
<body data-subtitle="肺炎重症度計算">
  <!-- 共通ヘッダー -->
  <div data-include="../partials/header.html"></div>

  <main>
    <a href="respiratory.index.html" class="back-link">← 呼吸器スコア一覧に戻る</a>

    <div class="section-title" style="margin-top: 16px;">
      A-DROP / CURB-65 / PSI 計算
    </div>

    <div class="wrapper">
      <div class="score-card-container">

        <!-- A-DROP -->
        <div class="section-title">A-DROP</div>
        <div class="score-card" style="cursor: default;">
          <div class="score-desc" style="font-size: 0.9rem;">
            <p style="margin-bottom: 8px;">
              以下の項目に該当するものにチェックしてください。
            </p>
            <div style="margin-left: 4px; margin-top: 4px;">
              <label style="display:block; margin-bottom:4px;">
                <input type="checkbox" id="adrop-age" />
                Age：男性≧70歳 / 女性≧75歳
              </label>
              <label style="display:block; margin-bottom:4px;">
                <input type="checkbox" id="adrop-dehydration" />
                Dehydration：BUN ≧ 21 mg/dL など脱水所見
              </label>
              <label style="display:block; margin-bottom:4px;">
                <input type="checkbox" id="adrop-resp" />
                Respiration：SpO₂≦90% または PaO₂≦60 Torr
              </label>
              <label style="display:block; margin-bottom:4px;">
                <input type="checkbox" id="adrop-orientation" />
                Orientation：意識障害あり
              </label>
              <label style="display:block; margin-bottom:4px;">
                <input type="checkbox" id="adrop-pressure" />
                Pressure：収縮期血圧≦90 mmHg
              </label>
            </div>

            <button type="button"
                    onclick="calculateADROP()"
                    style="margin-top: 10px; padding: 6px 10px; border-radius: 8px; border: 1px solid #4f8cff; background:#4f8cff; color:#fff; font-size:0.85rem; cursor:pointer;">
              A-DROP を計算
            </button>

            <div id="adrop-result" style="margin-top: 10px; font-weight:600;">
              スコア：-　重症度：
            </div>
            <div id="adrop-detail" style="margin-top: 4px; font-size:0.8rem; color:#555;">
            </div>
          </div>
        </div>

        <!-- CURB-65 -->
        <div class="section-title" style="margin-top: 24px;">CURB-65</div>
        <div class="score-card" style="cursor: default;">
          <div class="score-desc" style="font-size: 0.9rem;">
            <p style="margin-bottom: 8px;">
              以下の項目に該当するものにチェックしてください。
            </p>
            <div style="margin-left: 4px; margin-top: 4px;">
              <label style="display:block; margin-bottom:4px;">
                <input type="checkbox" id="curb-confusion" />
                C：Confusion（意識障害）
              </label>
              <label style="display:block; margin-bottom:4px;">
                <input type="checkbox" id="curb-urea" />
                U：Urea＞20 mg/dL（BUN＞7 mmol/L）
              </label>
              <label style="display:block; margin-bottom:4px;">
                <input type="checkbox" id="curb-rr" />
                R：Respiratory rate ≧ 30 / 分
              </label>
              <label style="display:block; margin-bottom:4px;">
                <input type="checkbox" id="curb-bp" />
                B：Blood pressure：収縮期＜90 または 拡張期≦60 mmHg
              </label>
              <label style="display:block; margin-bottom:4px;">
                <input type="checkbox" id="curb-age" />
                65：Age ≧ 65 歳
              </label>
            </div>

            <button type="button"
                    onclick="calculateCURB65()"
                    style="margin-top: 10px; padding: 6px 10px; border-radius: 8px; border: 1px solid #4f8cff; background:#4f8cff; color:#fff; font-size:0.85rem; cursor:pointer;">
              CURB-65 を計算
            </button>

            <div id="curb-result" style="margin-top: 10px; font-weight:600;">
              スコア：-　重症度：
            </div>
            <div id="curb-detail" style="margin-top: 4px; font-size:0.8rem; color:#555;">
            </div>
          </div>
        </div>

        <!-- PSI -->
        <div class="section-title" style="margin-top: 24px;">PSI（Pneumonia Severity Index / PORT）</div>
        <div class="score-card" style="cursor: default;">
          <div class="score-desc" style="font-size: 0.9rem;">

            <p style="margin-bottom: 6px;">
              年齢・基礎疾患・バイタル・検査所見から PSI（Fine スコア）を簡易計算します。
            </p>
            <p style="margin-bottom: 8px; font-size:0.78rem; color:#777;">
              ※原法に基づいた簡易実装です。実際の入院適応や治療方針はガイドライン・専門医の判断を優先してください。
            </p>

            <!-- Demographics -->
            <div style="margin-top: 6px; margin-left:4px;">
              <div style="margin-bottom:4px; font-weight:600;">1. 年齢・性別・居住状況</div>
              <div style="margin-bottom:4px;">
                年齢：
                <input type="number" id="psi-age" min="0" max="120" style="width:80px;" />
                歳
              </div>
              <div style="margin-bottom:4px;">
                性別：
                <label style="margin-right:8px;">
                  <input type="radio" name="psi-sex" value="male" checked /> 男性
                </label>
                <label>
                  <input type="radio" name="psi-sex" value="female" /> 女性
                </label>
              </div>
              <label style="display:block; margin-bottom:6px;">
                <input type="checkbox" id="psi-nursing" />
                介護・療養型施設入所中（nursing home resident）
              </label>
            </div>

            <!-- Comorbidities -->
            <div style="margin-top: 8px; margin-left:4px;">
              <div style="margin-bottom:4px; font-weight:600;">2. 基礎疾患</div>
              <label style="display:block; margin-bottom:2px;">
                <input type="checkbox" id="psi-neoplastic" />
                悪性腫瘍の既往（neoplastic disease）
              </label>
              <label style="display:block; margin-bottom:2px;">
                <input type="checkbox" id="psi-liver" />
                慢性肝疾患（肝硬変など）
              </label>
              <label style="display:block; margin-bottom:2px;">
                <input type="checkbox" id="psi-chf" />
                うっ血性心不全
              </label>
              <label style="display:block; margin-bottom:2px;">
                <input type="checkbox" id="psi-cvd" />
                脳血管疾患の既往
              </label>
              <label style="display:block; margin-bottom:2px;">
                <input type="checkbox" id="psi-renal" />
                慢性腎疾患
              </label>
            </div>

            <!-- Physical exam -->
            <div style="margin-top: 8px; margin-left:4px;">
              <div style="margin-bottom:4px; font-weight:600;">3. 身体所見</div>
              <label style="display:block; margin-bottom:2px;">
                <input type="checkbox" id="psi-ams" />
                意識障害あり（altered mental status）
              </label>
              <label style="display:block; margin-bottom:2px;">
                <input type="checkbox" id="psi-pulse125" />
                脈拍 ≥ 125 /分
              </label>
              <label style="display:block; margin-bottom:2px;">
                <input type="checkbox" id="psi-rr30" />
                呼吸数 ＞ 30 /分
              </label>
              <label style="display:block; margin-bottom:2px;">
                <input type="checkbox" id="psi-sbp90" />
                収縮期血圧 &lt; 90 mmHg
              </label>
              <label style="display:block; margin-bottom:2px;">
                <input type="checkbox" id="psi-temp-extreme" />
                体温 &lt; 35℃ または ≥ 40℃
              </label>
            </div>

            <!-- Labs & radiology -->
            <div style="margin-top: 8px; margin-left:4px;">
              <div style="margin-bottom:4px; font-weight:600;">4. 検査所見</div>
              <label style="display:block; margin-bottom:2px;">
                <input type="checkbox" id="psi-ph-low" />
                動脈血 pH &lt; 7.35
              </label>
              <label style="display:block; margin-bottom:2px;">
                <input type="checkbox" id="psi-bun-high" />
                BUN ≥ 30 mg/dL（9 mmol/L）
              </label>
              <label style="display:block; margin-bottom:2px;">
                <input type="checkbox" id="psi-na-low" />
                Na &lt; 130 mmol/L
              </label>
              <label style="display:block; margin-bottom:2px;">
                <input type="checkbox" id="psi-glu-high" />
                血糖 ≥ 250 mg/dL（14 mmol/L）
              </label>
              <label style="display:block; margin-bottom:2px;">
                <input type="checkbox" id="psi-hct-low" />
                ヘマトクリット &lt; 30%
              </label>
              <label style="display:block; margin-bottom:2px;">
                <input type="checkbox" id="psi-pao2-low" />
                PaO₂ &lt; 60 mmHg
              </label>
              <label style="display:block; margin-bottom:2px;">
                <input type="checkbox" id="psi-effusion" />
                胸部 X 線で胸水あり（pleural effusion）
              </label>
            </div>

            <button type="button"
                    onclick="calculatePSI()"
                    style="margin-top: 10px; padding: 6px 10px; border-radius: 8px; border: 1px solid #4f8cff; background:#4f8cff; color:#fff; font-size:0.85rem; cursor:pointer;">
              PSI を計算
            </button>

            <div id="psi-result" style="margin-top: 10px; font-weight:600;">
              PSIスコア：-　リスククラス：
            </div>
            <div id="psi-detail" style="margin-top: 4px; font-size:0.8rem; color:#555;">
            </div>

          </div>
        </div>

      </div>
    </div>
  </main>

  <!-- 共通フッター -->
  <div data-include="../partials/footer.html"></div>
</body>
</html>
